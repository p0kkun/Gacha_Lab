# リッチメニュー 4 個ボタン実装方法

## 実装するボタン

1. **A: ガチャ** → ガチャを引く機能
2. **B: マイページ** → ユーザー情報・獲得アイテム確認
3. **C: 抽選履歴** → 過去のガチャ結果確認
4. **F: 友達を招待** → 友達紹介機能

---

## リッチメニューレイアウト

### 推奨レイアウト：2 行 ×2 列

```
┌─────────┬─────────┐
│  A:ガチャ │ B:マイページ│
├─────────┼─────────┤
│ C:抽選履歴│ F:友達招待 │
└─────────┴─────────┘
```

**画像サイズ：** 2500px × 1686px（通常メニュー）

### 代替レイアウト：1 行 ×4 列（コンパクト）

```
┌─────┬─────┬─────┬─────┐
│ ガチャ│マイページ│履歴│招待│
└─────┴─────┴─────┴─────┘
```

**画像サイズ：** 2500px × 843px（コンパクトメニュー）

---

## 実装手順

### 1. リッチメニュー画像の作成

**推奨ツール：**

- LINE Creative Lab（無料）
- Figma、Photoshop、Canva など

**デザインのポイント：**

- 各ボタンエリアを明確に区切る
- アイコンとテキストを配置
- 視認性の高い色を使用（例：ダークグリーン背景に白文字）

### 2. ボタンエリアの座標設定（2 行 ×2 列の場合）

**通常メニュー（2500px × 1686px）の場合：**

#### ボタン A（ガチャ）- 左上

- **エリア座標：**
  - x: 0
  - y: 0
  - width: 1250
  - height: 843

#### ボタン B（マイページ）- 右上

- **エリア座標：**
  - x: 1250
  - y: 0
  - width: 1250
  - height: 843

#### ボタン C（抽選履歴）- 左下

- **エリア座標：**
  - x: 0
  - y: 843
  - width: 1250
  - height: 843

#### ボタン F（友達を招待）- 右下

- **エリア座標：**
  - x: 1250
  - y: 843
  - width: 1250
  - height: 843

---

## LINE Official Account Manager での設定

### 1. リッチメニューの作成

1. LINE Official Account Manager にログイン
2. 作成した公式アカウントを選択
3. 「リッチメニュー」→「新規作成」
4. メニュータイプ: **通常メニュー**を選択

### 2. 画像のアップロード

- 作成した画像（2500px × 1686px）をアップロード
- プレビューで表示を確認

### 3. アクション設定

#### ボタン A（ガチャ）

- **エリア**: 左上（x: 0, y: 0, width: 1250, height: 843）
- **アクションタイプ**: URI アクション
- **URI**: `https://miniapp.line.me/2008642684-d8jPmggE?action=gacha`
- **ラベル**: ガチャ

#### ボタン B（マイページ）

- **エリア**: 右上（x: 1250, y: 0, width: 1250, height: 843）
- **アクションタイプ**: URI アクション
- **URI**: `https://miniapp.line.me/2008642684-d8jPmggE?action=mypage`
- **ラベル**: マイページ

#### ボタン C（抽選履歴）

- **エリア**: 左下（x: 0, y: 843, width: 1250, height: 843）
- **アクションタイプ**: URI アクション
- **URI**: `https://miniapp.line.me/2008642684-d8jPmggE?action=history`
- **ラベル**: 抽選履歴

#### ボタン F（友達を招待）

- **エリア**: 右下（x: 1250, y: 843, width: 1250, height: 843）
- **アクションタイプ**: URI アクション
- **URI**: `https://miniapp.line.me/2008642684-d8jPmggE?action=referral`
- **ラベル**: 友達を招待

**注意：**

- 開発用 URL: `https://miniapp.line.me/2008642684-d8jPmggE`
- 本番用 URL: `https://liff.line.me/2008642684-d8jPmggE`（本番環境ではこちらを使用）
- LIFF ID: `2008642684-d8jPmggE`

### 4. 公開設定

- 作成したリッチメニューを「公開」に設定
- 友だち追加したユーザーに表示される

---

## LIFF アプリ側の実装

### URL パラメータの処理

```typescript
// app/page.tsx
"use client";

import { useSearchParams } from "next/navigation";
import { useEffect, useState } from "react";
import GachaModal from "@/components/GachaModal";

export default function Home() {
  const searchParams = useSearchParams();
  const [isGachaModalOpen, setIsGachaModalOpen] = useState(false);
  const [activePage, setActivePage] = useState<
    "home" | "mypage" | "history" | "referral"
  >("home");

  useEffect(() => {
    const action = searchParams.get("action");

    switch (action) {
      case "gacha":
        setIsGachaModalOpen(true);
        setActivePage("home");
        break;
      case "mypage":
        setActivePage("mypage");
        break;
      case "history":
        setActivePage("history");
        break;
      case "referral":
        setActivePage("referral");
        break;
      default:
        setActivePage("home");
    }
  }, [searchParams]);

  // ページに応じたコンテンツを表示
  const renderContent = () => {
    switch (activePage) {
      case "mypage":
        return <MyPageContent />;
      case "history":
        return <HistoryContent />;
      case "referral":
        return <ReferralContent />;
      default:
        return <HomeContent />;
    }
  };

  return (
    <>
      <div className="flex h-screen flex-col bg-gray-100">
        {/* メインコンテンツ */}
        <main className="flex-1 overflow-y-auto p-4">{renderContent()}</main>

        {/* 既存のメニュー領域 */}
        {/* ... */}
      </div>

      {/* ガチャモーダル */}
      {profile && (
        <GachaModal
          isOpen={isGachaModalOpen}
          onClose={() => setIsGachaModalOpen(false)}
          userId={profile.userId}
        />
      )}
    </>
  );
}
```

### 各ページコンポーネントの作成

```typescript
// components/MyPageContent.tsx
export default function MyPageContent() {
  return (
    <div className="space-y-4">
      <h1 className="text-2xl font-bold">マイページ</h1>
      {/* ユーザー情報、獲得アイテム一覧など */}
    </div>
  );
}

// components/HistoryContent.tsx
export default function HistoryContent() {
  return (
    <div className="space-y-4">
      <h1 className="text-2xl font-bold">抽選履歴</h1>
      {/* 過去のガチャ結果一覧 */}
    </div>
  );
}

// components/ReferralContent.tsx
export default function ReferralContent() {
  return (
    <div className="space-y-4">
      <h1 className="text-2xl font-bold">友達を招待</h1>
      {/* 友達紹介機能 */}
    </div>
  );
}
```

---

## リッチメニュー画像のデザイン例

### 推奨デザイン

**各ボタンの要素：**

- **背景色**: ダークグリーン（#2D5016 など）
- **文字色**: 白
- **アイコン**: 各機能を表すアイコン
- **テキスト**: 日本語（上）+ 英語（下）

**例：**

- **ガチャ**: 🎰 アイコン + "ガチャ" + "GACHA"
- **マイページ**: 🏠 アイコン + "マイページ" + "MY PAGE"
- **抽選履歴**: 📋 アイコン + "抽選履歴" + "HISTORY"
- **友達を招待**: 👥 アイコン + "友達を招待" + "INVITE FRIENDS"

---

## 実装チェックリスト

- [ ] リッチメニュー画像を作成（2500px × 1686px）
- [ ] LINE Official Account Manager でリッチメニューを作成
- [ ] 4 つのエリアにアクションを設定
- [ ] LIFF アプリ側で URL パラメータを処理
- [ ] 各ページコンポーネントを作成
- [ ] 動作確認

---

## まとめ

4 つのボタン（ガチャ、マイページ、抽選履歴、友達を招待）をリッチメニューとして実装する方法：

1. **リッチメニュー画像を作成**（2 行 ×2 列のレイアウト）
2. **LINE Official Account Manager で設定**（各エリアに URI アクションを設定）
3. **LIFF アプリ側で URL パラメータを処理**（各機能にルーティング）
4. **各ページコンポーネントを作成**（機能ごとの画面を実装）

これにより、リッチメニューから直接各機能にアクセスできるようになります。
